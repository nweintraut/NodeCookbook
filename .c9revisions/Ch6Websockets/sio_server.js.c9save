{"ts":1367813374801,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1367813465881,"patch":[[{"diffs":[[1,"var http = require('http');\nvar util = require('util');\n\nvar url = require('url')\nvar clientHtml = require('fs').readFileSync('./Ch6Websockets/sioclient.html');\nvar port = process.env.PORT || 3000;\nvar plainHttpServer = http.createServer(function(request, response){\n    response.writeHead(200, {'Content-Type': 'text/html'});\n    response.end(clientHtml);\n}).listen(port, function(){\n    console.log(\"Server launched\");    \n});\n\nvar webSocketServer = new WSServer({httpServer: plainHttpServer});\nvar accept = ['localhost', '127.0.0.1', 'nodecookbook.nweintraut.c9.io'];\nwebSocketServer.on('request', function(request){\n    console.log(\"Received request from \" + request.origin);\n    request.origin = request.origin || '*'; // no origin? Then use * as a wildcard.\n    accept.push(url.parse(request.origin).hostname); // plug to force passage\n    if(accept.indexOf(url.parse(request.origin).hostname) === -1 ){\n        request.reject();\n        console.log('disallowed' + request.origin);\n        return;\n    }\n    var websocket = request.accept(null, request.origin);\n    websocket.on('message', function(msg){\n        console.log('Received \"' + msg.utf8Data + '\" from ' + request.origin);\n        if(msg.utf8Data === 'Hello') {\n            websocket.send('WebSockets!');\n        }\n    });\n    websocket.on('close', function(code, desc){\n        console.log(\"Disconnect: ' + code + ' - \" + desc);\n    });\n});"]],"start1":0,"start2":0,"length1":0,"length2":1408}]],"length":1408,"saved":false}
{"ts":1367813594232,"patch":[[{"diffs":[[0,");\n\n"],[-1,"var url = require('url')\n"],[0,"var "]],"start1":53,"start2":53,"length1":33,"length2":8},{"diffs":[[0,"ent.html');\n"],[1,""],[0,"var port = p"]],"start1":124,"start2":124,"length1":24,"length2":24},{"diffs":[[0,"Content-"],[-1,"T"],[1,"t"],[0,"ype': 't"]],"start1":272,"start2":272,"length1":17,"length2":17},{"diffs":[[0,"var "],[-1,"webSocketServer = new WSServer({httpServer: "],[1,"io = require('socket.io').listen("],[0,"plai"]],"start1":405,"start2":405,"length1":52,"length2":41},{"diffs":[[0,"rver"],[-1,"}"],[0,");\n"],[-1,"var accept ="],[1,"io.set('origins',"],[0," ['l"]],"start1":453,"start2":453,"length1":24,"length2":28},{"diffs":[[0,".0.1"],[-1,"', 'nodecookbook.nweintraut.c9.io"],[1,":3000"],[0,"']"],[1,")"],[0,";\n"],[-1,"webS"],[1,"io.s"],[0,"ocket"],[-1,"Server.on('request', function(request){\n    console.log(\"Received request from \" + request.origin);\n    request.origin = request.origin || '*'; // no origin? Then use * as a wildcard.\n    accept.push(url.parse(request.origin).hostname); // plug to force passage\n    if(accept.indexOf(url.parse(request.origin).hostname) === -1 ){\n        request.reject();\n        console.log('disallowed' + request.origin);\n        return;\n    }\n    var websocket = request.accept(null, request.origin);\n    websocket.on('message', function(msg){\n        console.log('Received \"' + msg.utf8Data + '\" from ' + request.origin);\n        if(msg.utf8Data"],[1,"s.on('connection', function(socket){\n   socket.on('message', function(msg){\n       if (msg"],[0," ==="]],"start1":498,"start2":498,"length1":687,"length2":117},{"diffs":[[0,"        "],[-1," web"],[0,"socket.s"]],"start1":630,"start2":630,"length1":20,"length2":16},{"diffs":[[0,"nd('"],[-1,"WebS"],[1,"s"],[0,"ocket"],[-1,"s"],[1,".io"],[0,"!');\n"],[-1," "],[0,"    "]],"start1":647,"start2":647,"length1":24,"length2":22},{"diffs":[[0,"\n   "],[-1," "],[0,"});"],[1," "],[0,"\n"],[-1,"    websocket.on('close', function(code, desc){\n        console.log(\"Disconnect: ' + code + ' - \" + desc);\n    });"],[0,"\n});"]],"start1":673,"start2":673,"length1":127,"length2":13}]],"length":686,"saved":false}
{"ts":1367813600782,"patch":[[{"diffs":[[0,"   }); \n"],[-1,"\n"],[0,"});"]],"start1":674,"start2":674,"length1":12,"length2":11}]],"length":685,"saved":false}
{"ts":1367813930214,"patch":[[{"diffs":[[0,".1:3000'"],[1,", 'http://nodecookbook.nweintraut.c9.io/'"],[0,"]);\nio.s"]],"start1":500,"start2":500,"length1":16,"length2":57}]],"length":726,"saved":false}
{"ts":1367813971931,"patch":[[{"diffs":[[0,"', '"],[-1,"http://"],[0,"node"]],"start1":507,"start2":507,"length1":15,"length2":8}]],"length":719,"saved":false}
{"ts":1367814007518,"patch":[[{"diffs":[[0,"', '"],[-1,"nodecookbook.nweintraut."],[0,"c9.i"]],"start1":507,"start2":507,"length1":32,"length2":8}]],"length":695,"saved":false}
{"ts":1367814034777,"patch":[[{"diffs":[[0,"erver);\n"],[1,"// "],[0,"io.set('"]],"start1":452,"start2":452,"length1":16,"length2":19}]],"length":698,"saved":false}
{"ts":1367814467927,"patch":[[{"diffs":[[0,"ocket){\n"],[1,"    socket.emit('ready');\n"],[0,"   socke"]],"start1":563,"start2":563,"length1":16,"length2":42}]],"length":724,"saved":false}
