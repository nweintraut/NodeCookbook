{"ts":1367850530772,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1367850903526,"patch":[[{"diffs":[[1,"var io = require('socket.io').listen(8081);\nvar sioclient = require('socket.io-client');\nvar widgetScript = require('fs').readFileSync('widget_client.js');\nvar url = require('url');\n\nvar totals = {};\n\nio.configure(function(){\n   io.set('resource', '/loc');\n   io.enable('browser clietn gzip');\n});\nsioclient.builder(io.transports(), function(err, siojs){\n    if(!err){\n        io.static.add('/widget.js', function(path, callback){\n            callback(null, new Buffer(siojs + \";\" + widgetScript));\n        });\n    }\n});\nio.sockets.ono('connection', function(socket){\n   var origin = (socket.handshake.xdomain) ? url.parse(socket.handshake.headers.origin). hostname : 'local';\n   totals[origin] = (totals[origin]) || 0;\n   totals[origin] += 1;\n   socket.join(origin);\n   \n   io.sockets.to(origin).emit('total', totals[origin]);\n   socket.on('disconnect', function(){\n       totals[origin] -= 1;\n       io.sockets.to(origin).emit('total', totals[origin]);\n   });\n});"]],"start1":0,"start2":0,"length1":0,"length2":965}]],"length":965,"saved":false}
